<% provide :container_fluid, true %>
<% provide :can_be_ajaxed, true %>
<% provide :wrap_whitespace, true %>
<% provide :use_url_as_page_title, true %>
<% content_for :heading do %>
  Orders
<% end %>

<% provide :heading_buttons do %>
  <div class="btn-group">
    <% if current_company.id == 1847 %>
      <a href="#export-filters" class="btn btn-success btn-rounded align-self-center btn-block-sm-down ml-1 mb-md-0 mb-1 order-filter" data-toggle="modal" title="All sales orders"><i class="fal fa-download mr-1"></i>Orders</a>
    <% else %>
      <a href="<%= export_all_customers_orders_path(format: :csv) %>" class="btn btn-success btn-rounded align-self-center btn-block-sm-down ml-1 mb-md-0 mb-1" data-toggle="tooltip" title="All sales orders"><i class="fal fa-download mr-1"></i>Orders</a>
    <% end %>
  </div>
<% end %>

<%= form_tag export_all_customers_orders_path(format: :csv), method: 'get', class: 'my-2 form-row' do %>
  <div class="message-in-order">
    <div id="export-filters" class="modal hide fade" role="dialog" aria-hidden="true">
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Order filters</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <div class="form-group mt-3">
              <label>Date Range</label>
              <input type="text" id="daterange" name="daterange" class="form-control" data-toggle="daterangepicker" data-direction="right" placeholder="Pick a daterange">
              <small style="font-size: 10px;">Select a range for the order report</small>
            </div>
            <div class="form-group">
              <label>Amount(INR)</label>
              <input type="number" id="amount" name="amount" class="form-control" min="0">
              <small style="font-size: 10px;">Fetches orders with value less than the amount mentioned</small>
            </div>
          </div>
          <div class="modal-footer">
            <button type="submit" class="btn btn-success">Apply</button>
          </div>
        </div>
      </div>
    </div>
  </div>
<% end %>

<% content_for :header_row do %>
  <th class="no-sort all"></th>
  <th class="no-sort all" data-name="order_number">Order #</th>
  <th class="no-sort desktop" data-name="created_at">Order Date</th>
  <th class="no-sort desktop" data-name="">PO #</th>
  <th class="no-sort desktop" data-name="">PO Date</th>
  <th class="no-sort all" data-name="order_number">Inquiry #</th>
  <th class="no-sort desktop" data-name="cp_ship_to">Ship To</th>
  <th class="no-sort desktop" data-name="">Company</th>
  <th class="no-sort desktop" data-name="">Order Total</th>
  <th class="no-sort desktop" data-name="">Expected Delivery Date</th>
  <th class="no-sort desktop" data-name="">Actual Delivery Date</th>
  <th class="no-sort desktop" data-name="cp_status">Order Status</th>
<% end %>

<% content_for :filter_row do %>
  <td data-filter="false"></td>
  <td data-filter="false"></td>
  <td data-filter="false"></td>
  <td data-filter="false"></td>
  <td data-filter="false"></td>
  <td data-filter="false"></td>
  <td data-filter="ajax"></td>
  <td data-filter="false"></td>
  <td data-filter="false"></td>
  <td data-filter="false"></td>
  <td data-filter="false"></td>
  <td data-filter="dropdown"></td>
<% end %>

<div class="col-lg-12">
  <%= render layout: 'shared/layouts/datatable' do %>
  <% end %>
</div>
