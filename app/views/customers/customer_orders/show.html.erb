<% provide :controller_is_aliased, true %>
<% content_for :page_title do %>
  Online Orders
<% end %>

<div class="col-12">
  <section class="pt-3 pt-lg-4 pb-2 pb-lg-3">
    <div class="d-md-flex justify-content-between">
      <h1 class="display-5 mb-1">Order #<%= @customer_order.id %></h1>
    </div>
    <p class="lead mt-1">
      There are a total of <strong><%= @customer_order.rows.count %></strong> product(s) in this order.
    </p>
  </section>

  <div class="card mb-2">
    <div class="card-body py-2">
      <table class="datatable table table-bordered dt-responsive wrap-whitespace w-100" data-fixed-header="false">
        <thead>
        <tr>
          <th class="no-sort desktop">Image</th>
          <th class="no-sort all">Product</th>
          <th class="no-sort">Price</th>
          <th class="all">Quantity</th>
          <th class="no-sort all">Subtotal</th>
        </tr>
        </thead>
        <tbody>
        <% @customer_order.rows.each do |customer_order_row| %>
          <tr>
            <td>
              <% if customer_order_row.customer_product.best_images.present? %>
                <img src="<%= url_for_image(customer_order_row.customer_product.best_images.first, fallback_url: image_path('coming_soon.png')) %>" alt="<%= customer_order_row.customer_product.sku %>" height="40"/>
              <% else %>
                <img src="<%= image_path('coming_soon.png') %>" alt="<%= customer_order_row.customer_product.sku %>" height="40"/>
              <% end %>
            </td>
            <td><%= customer_order_row.product.name.truncate(80) %></td>
            <td><%= format_currency(customer_order_row.customer_product.customer_price.to_f) %></td>
            <td><%= customer_order_row.quantity %></td>
            <td><%= format_currency(customer_order_row.customer_product.customer_price.to_f * customer_order_row.quantity) %></td>
          </tr>
        <% end %>
        </tbody>
      </table>
    </div>

    <div class="card-footer">
      <div class="form-row">
        <div class="col-md-6">
          <a class="btn btn-outline-dark btn-block" href="<%= customers_customer_orders_path %>"><i class="fal fa-arrow-circle-left mr-1"></i>Browse Online Orders</a>
        </div>
        <div class="mt-1 mt-md-0 col-md-6">
          <a class="btn btn-success btn-block" href="<%= customers_products_path %>">Browse Products<i class="fal fa-arrow-circle-right ml-1"></i></a>
        </div>
      </div>
    </div>
  </div>
</div>