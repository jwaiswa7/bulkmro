<% if content_for?(:heading) || (content_for?(:can_be_directly_created) && policy(current_model.singularize.to_sym).new?) || !content_for?(:hide_table_desc) %>
  <section class="pt-3 pt-lg-4 pb-2 pb-lg-3">
    <div class="d-md-flex justify-content-between">
      <% if content_for?(:heading) %>
        <h1 class="display-5 mb-1"><%= yield :heading %></h1>
      <% else %>
        <h1 class="display-5 mb-1"><%= current_model.humanize %></h1>
      <% end unless content_for?(:hide_table_heading) %>

      <% if content_for?(:can_be_directly_created) && policy(current_model.singularize.to_sym).new? %>
        <a href="<%= [request.path, '/', 'new'].join %>" class="d-sm-block btn btn-success btn-rounded align-self-center btn-block-sm-down">
          <i class="fal fa-plus-circle mr-1"></i>New <%= controller_path.split('/').last.singularize.upcase %>
        </a>
      <% end %>

      <% if content_for?(:can_be_directly_exported) && policy(current_model.singularize.to_sym).export_sheet? %>
        <a href="<%= [request.path, '/', 'export_sheet.csv'].join %>" class="d-sm-block btn btn-success btn-rounded align-self-center btn-block-sm-down">
          <i class="fal fa-download mr-1"></i>Export <%= controller_path.split('/').last.singularize.split("_").join(" ").upcase %>
        </a>
      <% end %>
    </div>

    <% unless content_for?(:hide_table_desc) %>
      <p class="lead mt-1">
        All <%= current_model.humanize.downcase %> filterable in any way that we want.
      </p>
    <% end %>
  </section>
<% end %>

<div class="input-group input-group-round">
  <div class="input-group-prepend">
    <span class="input-group-text"><i class="material-icons"></i></span>
  </div>
  <input type="search" name="q" class="form-control filter-list-input" placeholder="Filter by anything [press ENTER to SEARCH]" value="<%= params[:q] %>" onchange="searchsubmit(this.value)">
</div>

<div class="accordion mt-2" id="product-filters">
  <div class="card">
    <a class="card-header py-2 text-black-50 text-uppercase" href="#" data-toggle="collapse" data-target="#filters">
      <strong>Filters</strong>
    </a>
    <div id="filters" class="collapse show" data-parent="#product-filters">
      <%= simple_form_for :fake do |f| %>
        <div class='card-body'>
          <p class="text-uppercase text-black-50 mb-2">Categories</p>
          <div class="form-row">
            <div class="col-md-3 col-sm-4 col-lg-2">
              <%= f.input :office_supplies, as: :boolean, wrapper: :custom_boolean %>
              <%= f.input :travel, as: :boolean, wrapper: :custom_boolean %>
              <%= f.input :utilities, as: :boolean, wrapper: :custom_boolean %>
              <%= f.input :stationery, as: :boolean, wrapper: :custom_boolean %>
            </div>
            <div class="col-md-3 col-sm-4 col-lg-2">
              <%= f.input :health, as: :boolean, wrapper: :custom_boolean %>
              <%= f.input :cleaning_equipment, as: :boolean, wrapper: :custom_boolean %>
              <%= f.input :networking, as: :boolean, wrapper: :custom_boolean %>
              <%= f.input :security, as: :boolean, wrapper: :custom_boolean %>
            </div>
            <div class="col-md-3 col-sm-4 col-lg-2">
              <%= f.input :kitchen_supplies, as: :boolean, wrapper: :custom_boolean %>
              <%= f.input :manufacturing, as: :boolean, wrapper: :custom_boolean %>
              <%= f.input :machinery, as: :boolean, wrapper: :custom_boolean %>
              <%= f.input :lighting, as: :boolean, wrapper: :custom_boolean %>
            </div>
          </div>
          <div class="form-row mt-2">
            <div class="col-4 col-lg-2 col-md-3">
              <a href="#" class="btn btn-outline-danger btn-block">Clear</a>
            </div>
            <div class="col-8 col-lg-10 col-md-0">
              <a href="#" class="btn btn-success btn-block">Filter products</a>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>

<div class="form-row mt-2" id="grid_container">
  <% if @products.count > 0 %>
    <% @products.each do |product| %>
      <div class="col-xl-2 col-lg-3 col-md-4 col-sm-6 col-xs-12">
        <div class="card mb-2">
          <div class="card-body">
            <a href="<%= customers_product_path(product) %>">
              <% if product.images.present? %>
                <img src="<%= url_for_image(product.images.first, fallback_url: image_path('coming_soon.png')) %>"/>
              <% else %>
                <img src="<%= image_path('coming_soon.png') %>"/>
              <% end %>
              <h5 class="mb-0 text-small"><strong><%= truncate(product.name, :length => 25) %></strong></h5>
              <h5 class="mb-0 text-small"><strong>(#<%= product.sku %>)</strong></h5>
              <h5 class="mb-0 mt-1 text-small text-black-50">
                <strong><%= product.latest_unit_cost_price.to_f == 0.0 ? '-' : format_currency(product.latest_unit_cost_price.to_f) %></strong>
              </h5>

              <hr class="my-2">
              <p class="mb-0 text-small text-black-50">
                <strong class="d-block"><%= product.brand.try(:name) ? product.brand.try(:name) : '-' %></strong>
                <!--              <em class="d-block">MOQ - 50</em>-->
              </p>
            </a>
          </div>
          <div class="card-footer p-2">
            <div class="form-row">
              <!--              <div class="col-4">-->
              <!--                <input type="text" class="form-control" placeholder="1" id="quantity_<%#= product.id %>" />-->
              <!--              </div>-->
              <div class="col-12">
                <%= link_to "Add to Cart", customers_cart_items_path(product_id: product.id, quantity: 1), method: :post, remote: true, class: "btn btn-block btn-success" %>
              </div>
            </div>
          </div>
        </div>
      </div>
    <% end %>
  <% else %>
    <div class="col-12">
      <div class="card mb-12">
        <div class="card-body">
          <p class="text-small text-black-50 ">
            <strong class="d-block ">No matching record found</strong>
          </p>
        </div>
      </div>
    </div>
  <% end %>
</div>

<div class="col-12">
  <%= paginate @products_paginate, remote: true, :params => {:view => "grid_view", :q => params[:q]} %>
</div>